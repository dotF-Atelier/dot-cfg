BRDF

diffuse

specular

subsurface

transmission transmission scattering

Figure 1: Rendered examples using our new BSDF.

refraction

Extending the Disney BRDF to a BSDF with Integrated Subsurface Scattering

by Brent Burley, Walt Disney Animation Studios

1 Introduction
We introduced a new physically based shading model on Wreck-It Ralph [Bur12], and we used this single, general-purpose BRDF on all materials (except hair). This model, which has come to be known as the Disney BRDF, is able to reproduce a wide range of materials with only a few parameters. For our next ﬁlm, Frozen, we continued to use this BRDF unmodiﬁed, but eﬀects like refraction and subsurface scattering were computed separately from the BRDF, and indirect illumination was approximated using point clouds. All of these eﬀects were combined through ad hoc shading in an additive way.
Starting with Big Hero 6 in 2014, we switched from ad hoc lighting and shading to path-traced global illumination where refraction, subsurface scattering, and indirect illumination were all integrated in a single physically based framework. With path-traced global illumination, energy conservation becomes critical as non-energy conserving materials may amplify light and prevent the image from converging. The additive nature of ad hoc shading is generally not energy conserving given that the various components are redundant representations of the refracted energy. In order to ensure energy conservation, we extended our BRDF to a uniﬁed BSDF model where all such eﬀects are accounted for in a consistent, energy-conserving way. Examples of our new model are shown in Figure 1.

Figure 2: Various shading model representations of refracted energy.
1

1.1 Representations of refracted energy
When a ray hits a surface, the ray splits with some of the energy being reﬂected and some being refracted into the surface. The reﬂected portion of the ray is well described by a specular BRDF. However, the refracted portion of the ray, depending on the material, may continue through the object to be transmitted out the other side, or it may scatter internally and be re-emitted at some other point on the surface. These cases are traditionally handled as separate shading models as illustrated in Figure 2 and described below:
Ideal refraction: a smooth dieletric surface (such as glass) splits incident rays into reﬂected and refracted portions. The refracted rays change direction according to Snell’s law, and the fraction of energy being reﬂected or refracted is described by the Fresnel equations. This is typically handled as a special purpose shader due to the delta distributions involved.
Specular BSDF: a rough surface scatters reﬂected and refracted rays at the surface boundary. This is commonly modeled using a microfacet BSDF, or Bidirectional Scattering Distribution Function [WMLT07]. Such a BSDF only describes specular scattering, and only at a single point; a ray refracting into a solid and exiting the other side would be represented as two BSDF scattering events.
BSSRDF + specular BRDF: refracted rays may be scattered multiple times below the surface, exiting at an arbitrary point away from the entrance point. The amount of energy being transmitted by such scattering between two locations and directions on a surface is described by a BSSRDF, or Bidirectional Surface Scattering Distribution Function [JMLH01]. For practicality, BSSRDF implementations typically employ a diﬀusion approximation that makes severe geometric assumptions.
BRDF: when the scatter distance is small compared to the rendering precision (e.g. smaller than a projected pixel), subsurface scattering can be eﬀectively approximated by a diﬀuse BRDF. Such scattering is often assumed to be isotropic, i.e. Lambertian, though this is not the case for the Disney BRDF.
Thin-surface BSDF: when shading a thin, translucent surface (i.e. with no geometrically modeled internal volume), a thin-surface BSDF can represent both diﬀuse and specular reﬂection as well as diﬀuse and specular transmission.
Notably, each of these models is an approximation of the previous model. The thin-surface BSDF is thus an approximation of an approximation of an approximation of an approximation! Each of these approximations has their place, and our uniﬁed model incorporates aspects of all of them.

1.2 A uniﬁed scattering model

We would like to represent all forms of scattering within a uniﬁed model. The most general model perhaps would be a specular BSDF for the surface combined with a volumetric scattering model for the interior as shown in Figure 3 to the right. Such a model can reproduce all physical eﬀects, though it is not always practical to do so; e.g. in this model surface color is derived solely from absorption during volume scattering though it would be suﬃcient and obviously more eﬃcient to use a diﬀuse BRDF when the scatter distance is negligible.
Arguably, one might consider the BSSRDF as the most general uniﬁed representation of scattering since, mathematically at least, it fully describes all scattering between any two points and

Figure 3: A specular BSDF reﬂects and refracts rays at the surface. Refracted rays are scattered and partially absorbed within the volume. When these rays reach the surface, they are scattered again according to another specular BSDF.

2

Figure 4: The Disney BRDF is a blend of metallic and dielectric BRDF models based on a metallic shader parameter. For our uniﬁed BSDF, we extend our dielectric BRDF with integrated subsurface scattering, and we blend in an additional specular BSDF based on a new specTrans parameter.
directions on a surface. However, the BSSRDF is an impractical representation for non-diﬀuse scattering given that the entry and exit points and directions must be known a priori, yet the exit point is often determined by tracing through the object after scattering at the surface. The general form of the BSSRDF presents a chicken and egg problem (or more technically, an example of the searchlight problem from radiative transport theory). The diﬀusion approximation of the BSSRDF, however, sidesteps this problem.
Rather than trying to use a single general model, our uniﬁed model is a blend of models, combining our existing BRDF with a specular BSDF and a subsurface scattering model. When the specular BSDF is selected and combined with a volume shader for the interior, we have the general scattering model of Figure 3, but we still have the more eﬃcient approximations of the BRDF and subsurface diﬀusion available.
We refer to our uniﬁed model as the Disney BSDF though this isn’t strictly correct given that our model includes subsurface scattering. Because of this, we more formally refer to our uniﬁed model as the Disney BSDF with integrated subsurface scattering.
2 Disney BSDF
We note that our Disney BRDF is already a blend of metallic and dielectric models. To support refraction, we extend this by blending an additional specular BSDF model as shown in Figure 4. A new parameter, specular transmission or specTrans, controls the blending. As seen in the ﬁgure, the metallic model takes precedence, but fractional blends of all three models are possible. If each constituent model is energy conserving, then the blend will be as well.
For thin surfaces, as suggested in Figure 2, special treatment is required. There’s no internal volume present within which to perform subsurface scattering, so an approximation must be used. Also, for refraction, both the entering and exiting scattering events must be simultaneously simulated.
Each of these models is discussed in the following subsections. First, we recap the features of our Disney BRDF, then we describe the new additions.
2.1 Disney BRDF Recap
The Disney BRDF was largely based on observations of measured materials, primarily from the MERL 100 materials [MPBM03]. As such it was empirically inspired but follows an ad hoc construction where existing physically derived models didn’t adequately reproduce measured material results.
Our BRDF includes two specular lobes: a microfacet reﬂection lobe with anisotropic roughness and an optional clearcoat reﬂection lobe. The microfacet reﬂection follows standard models [CT81, WMLT07]. The clearcoat lobe is isotropic and follows a similar but non-physical construction.
3

Figure 5: Top: Our specular BSDF with varying IOR from 1 to 2. (The leftmost sphere is shown at 1.02 rather than 1, otherwise it would be invisible.) Bottom: specTrans varying from 0 to 1 with IOR of 1.33.
Our BRDF diﬀuse response is directional (i.e. non-Lambertian). Speciﬁcally, the grazing retroreﬂection response depends on the microfacet reﬂection roughness and ranges from darkening for smooth surfaces to brightening for rough surfaces. We also include an optional sheen component which adds grazing forward reﬂection. Both of these model observed eﬀects in the measured materials which we presume to be caused by multiple-scattering eﬀects between and through microsurface features.
Additionally, a completely separate (also directional and also roughness dependent) diﬀuse model is included that approximates subsurface scattering. This is still a BRDF, since no actual subsurface scattering is performed. This model is blended with the primary diﬀuse according to a user parameter. We have removed this model from our Disney BSDF in favor of true subsurface scattering for solid surfaces, though we retain it thin-surface shading.
The metallic portion of our BRDF simply kills all diﬀuse reﬂectance and sets the incident specular response to the speciﬁed baseColor. This baseColor parameter is shared with the dielectric (i.e. nonmetallic) diﬀuse model and thus serves as an approximate estimate of the albedo for both models. We extend this interpretation of the baseColor parameter to our specular BSDF model.
While the Disney BRDF is not strictly energy conserving, for reasons discussed in Section 5.1, the parameters are deﬁned in such a way as to produce plausible results that are energy conserving given plausible albedos which are typically much less than one.
2.2 Specular BSDF
Our specular BSDF directly extends the microfacet reﬂection lobe of our BRDF to refraction. Examples of our specular BSDF and blended specular transmission are shown in Figure 5.
We follow the derivation of Walter et al. [WMLT07]. Rays are refracted according to Snell’s law, ηi sin θi = ηo sin θo where ηi and ηo are the indices of refraction, or IORs, of the two media at the refractive surface. Note that refraction only depends on the ratio of indices, η = ηo/ηi, commonly referred to as the relative IOR. When coming from air (where ηi ≈ 1.0003 and typically assumed to be 1) the IOR and relative IOR are the same, but care must be taken to invert the value when refracting out of an object.
Snell’s law describes the bending of rays, but less obviously, it also describes the spreading of rays. Speciﬁcally, the apparent radiance of a refracted ray will be scaled by η2 which, as Veach shows [Vea97], is equivalent to the change in projected solid angle.
To derive the microfacet BSDF as the sum of a BRDF and BTDF, fs(i, o, n) = fr(i, o, n) + ft(i, o, n), Walter et al. ﬁrst deﬁne the reﬂection and refraction half-vectors, applying Snell’s law in
4

the refraction case:

hr =

i+o i+o

ht = −

i + ηo i + ηo

(1)

then apply three correction factors to 1) transform incident radiance onto the microsurface, 2) transform

scattered radiance back to the macrosurface, and 3) account for the change in solid-angle measure,

∂ωh ∂ωo

. For refraction, a fourth factor is needed to account for the change in solid angle due to refractive

spreading as mentioned above (a factor omitted by Walter et al.). Combining these factors results in:

fr(i, o, n)

=

|i · hr| |i · n|

·

|o · hr| |o · n|

·

(i

·

hr

1 +o

·

hr )2

·

F (i, hr)G(i, o, hr)D(hr)

=

Fr(i, hr)G(i, o, hr)D(hr) 4|i · n||o · n|

(2)

ft(i, o, n)

=

|i · ht| |i · n|

·

|o · ht| |o · n|

·

(i

·

ht

η2 + ηo

·

ht)2

·

1 η2

·

(1

−

F (i, ht))G(i, o, ht)D(ht)

When the obvious terms are cancelled in fr (noting that i · hr = o · hr) we have the familiar form of the microfacet BRDF. Note: these formulae are deﬁned with respect to integration over the outgoing hemisphere. The BRDF is reciprocal but the BTDF is not, so care must be taken when choosing i and o. In particular, for path tracing from the camera, i would represent the view direction and o the light direction.
The 1/η2 spreading factor can usually be omitted without incident given that one usually sees through refractive solids where the factor and inverse factor cancel out. And doing so will avoid undesirable brightening when the camera sensor is placed in a medium other than air (e.g. under water); while it is not physically correct to place the camera under water without some sort of airwater transition, such a transition is not typically modeled. However, with bidirectional methods such as photon mapping, energy (photons) can be deposited inside a refractive medium, and correct integration requires that the factor be included. Note: when tracing photons (which have no solid angle), the spreading factor should not be used.
To this basic model we add:

• clearcoat: this is unchanged from our BRDF, contributing additional reﬂection and not participating in refraction.

• surface absorption: we multiply the refraction result by the square root of the surface color, which, after both the entering and exiting scattering events are accounted for, produces the expected albedo.

• volumetric absorption: we apply volumetric absorption based on the length of refracted paths through the solid.

• sheen: though non-physical, we include the sheen component from our BRDF. We note that the rough dielectric model presented by Walter et al. loses energy due to lack of microfacet interreﬂection/refraction and the sheen component can approximately compensate for it, and such compensation was deemed necessary by our artists. We discuss this issue further in Section 5.1.

Volumetric absorption parameterization: The Beer-Lambert law states that the transmit-
tance T through a volume is exponential with respect to optical depth which can be represented as an absorption coeﬃcient σa multiplied by distance d, thus T = e−σad. This is straightforward to

5

Figure 6: Volumetric absorption on refractive solids. The transmittance color is (1, 0.7, 0.1) with transmittance atDistance values of (16, 8, 4, 2, 1) from left to right on prisms with base thickness of 1.5 and IOR of 1.3.

implement but the absorption coeﬃcient is unintuitive. Instead, we add two new parameters: a transmittance color, and corresponding atDistance factor from which we infer the absorption coeﬃcient by inverting the transmittance equation: σa = −(log T )/d. An example is shown in Figure 6.

2.3 Dielectric BRDF with integrated subsurface scattering
To extend our dielectric BRDF with subsurface scattering, we ﬁrst refactor our diﬀuse lobe into directional microsurface eﬀects and non-directional (i.e. Lambertian) subsurface eﬀects, then we replace the Lambertian portion of the diﬀuse lobe with either a diﬀusion model or a volumetric scattering model. This preserves the microsurface eﬀects, allowing our diﬀusion model to converge to the same result as the diﬀuse BRDF when the scatter distance is small.
For the Disney BRDF, our directional diﬀuse model was previously deﬁned as:

fd

=

baseColor π

1 + (FD90 − 1)(1 − cos θl)5

1 + (FD90 − 1)(1 − cos θv)5

where

(3)

FD90 = 0.5 + 2 roughness cos2 θd

If we had used FD90 = 0, this would have been the standard Lambertian diﬀuse with smooth-surface Fresnel factors (using the Schlick Fresnel approximation here), but as discussed in our 2012 report this produces an unnaturally dark grazing response. So instead of going to 0 at grazing angles, i.e. when the light or view direction is 90 degrees from the surface normal, we limit the edge darkening to 0.5, and increase gain at retro-reﬂection by up to 2.5 times for maximally rough surfaces. The cos2 θd factor smoothly isolates this gain to grazing retro-reﬂection. Though ad hoc, this shape and relationship to roughness were chosen based on observations of measured data.
To enable swapping out the Lambertian diﬀuse with subsurface scattering while retaining our rough-surface Fresnel factors and retro-reﬂective gain, we refactor our diﬀuse model as:

fd = fLambert (1 − 0.5FL) (1 − 0.5FV ) + fretro−reflection

fLambert

=

baseColor π

fretro−ref lection

=

baseColor π

RR

(FL

+

FV

+ FLFV

(RR − 1))

(4)

where

FL = (1 − cos θl)5 FV = (1 − cos θv)5 RR = 2 roughness cos2 θd

6

Figure 7: The diﬀusion BSSRDF model approximates diﬀuse multiple scattering, often depending only on distance r between surface points. This can be augmented with single scattering which assumes ideal refraction.

Our sheen component additionally models grazing microsurface transmission as sheen · (1 − cos θd)5, optionally tinted towards baseColor according to the sheenTint parameter. Given that this is already a separately added component, it is unaﬀected when swapping out the Lambertian diﬀuse component with subsurface scattering.

2.4 Subsurface diﬀusion

Subsurface diﬀusion in the form of the dipole model was introduced to graphics in a seminal paper

by Jensen et al. [JMLH01]. In this work, it is assumed that the surface bounds a ﬂat, semi-inﬁnite

slab—a reasonable assumption when the scattering distance is small with respect to surface curvature

and thickness. The energy propagating between two points is deﬁned using radiative transport theory

and the multiple scattering diﬀusion component is approximately determined with single scattering

separately integrated, illustrated in Figure 7. Subsequent work has improved this approximation, but

has retained the geometric assumptions and increased the cost of evaluation [dI11, HCJ13].

Artistic control can be a challenge with diﬀusion models. Artists prefer to specify the diﬀuse

albedo and mean multiple scattering distance, and the radiative transport scattering coeﬃcients must

therefore be inferred by inverting the diﬀusion equation [JB02]; such “albedo inversion” must typically

done with iterative or tabulated methods, both of which can have trouble with high albedos. Another

challenge is that diﬀusion proﬁles are often too blurry given that they typically only model multiple

scattering, leading to the use of two or more proﬁles combined in an ad hoc manner.

For our diﬀusion model, we take a diﬀerent approach. First, we observe through Monte Carlo

simulation that for typical scattering parameters the diﬀusion proﬁle including single scattering is

well-approximated by a sum of two exponentials as shown in Figures 8 and 9. Based on simulating

and ﬁtting a range of scattering parameters, we chose the following prototypical shape for our diﬀusion

proﬁle:

Rd(r)

=

e−r/d + e−r/(3d) 8π d r

(5)

To evaluate the diﬀusion contribution, incident radiance must be integrated over the entire surface.

Notably, when integrated over the hypothetical inﬁnite surface over which diﬀusion models are deﬁned,

our proﬁle is intrinsically normalized:

2π ∞

Rd(r) r dr dφ = 1

(6)

00

and thus we refer to our proﬁle as normalized diﬀusion. Because our proﬁle is normalized, we can achieve our desired diﬀuse color simply by multiplying the integrated result at the end by baseColor, avoiding the need for albedo inversion and guaranteeing consistency with our diﬀuse BRDF. We expose the parameter d directly to artists as scatterDistance with components for red, green and blue. When scatterDistance is 0, we simply revert to our diﬀuse BRDF. A production result image is shown in Figure 10, and the eﬀect of varying scatterDistance is shown in Figure 11.
In addition to being more consistent and convenient, Christensen [CB15] showed that our proﬁle is also more accurate compared to state-of-the-art diﬀusion proﬁles, even when they are augmented with

7

r Rd(r)

Monte Carlo reference 0.031 exp(-0.41 r) + .02 exp(-1.7 r) MC excluding single-scattering dipole
r Figure 8: Monte Carlo diﬀusion simulation for skin1.r from [JMLH01] with exponential ﬁt compared with Dipole.
exponential fit Monte Carlo reference dipole
Figure 9: Monte Carlo diﬀusion rendering of skin1 at a shadow boundary compared with exponential ﬁt and dipole diﬀusion. The exponential ﬁt is indistinguishable from the reference whereas the dipole model is visibly blurry with an objectionable cyan band, both frequent complaints of artists.
8

Figure 10: Image from Big Hero 6 rendered using our normalized diﬀusion subsurface model. Image c Disney 2014.
Figure 11: Unit spheres rendered with scatterDistance varying from (0.0, 0.0, 0.0) to (0.5, 0.25, 0.125). The spheres are lit by a furnace and artiﬁcially shadowed below the horizon to emphasize the shadow boundary. Notably, the ﬁrst sphere uses the diﬀuse BRDF approximation, showing that the diﬀusion converges to a consistent result.
9

Figure 12: Left: a surface cavity is illustrated with a representative scattering path. Middle: the diﬀusion approximation views the surface as ﬂat, depending only on the distance between the points and overestimating the energy transferred. Right: we use the angle between normals of opposing surfaces to reduce the diﬀusion amount.
single scattering (which is implicitly included in our proﬁle). Christensen derived simple equations to relate our parameter d to the physical mean free path from radiative transport theory. Such relations facilitated comparison with other proﬁles, and also allowed our proﬁle to be used as a drop-in replacement.
Our proﬁle is also more eﬃcient. In addition to having a relatively simple form and avoiding a separate integration for single scattering, it can be directly and analytically importance sampled as the CDF and inverse CDF are trivially derived. Note: to do so requires sampling each exponential lobe separately which is not a problem; three proﬁles are typically required for red, green and blue, and thus six lobes must be sampled which can be easily combined with multiple-importance sampling.
Though our diﬀusion proﬁle is eﬃcient to evaluate and matches the Monte Carlo reference well, there are still several drawbacks:
• The semi-inﬁnite slab assumption creates artifacts when the scattering distance is large, as evident in Figure 13.
• Surface cavities are a particular problem, illustrated in Figure 12 which we partly address by fading out the diﬀusion result as the surfaces become opposing.
• Diﬀusion tends to blur out small surface details because the surface normals are ignored by the diﬀusion proﬁle.
• Sampling can be diﬃcult and expensive. Diﬀusion integration requires distributing samples over the entire surface with known density, preferably proportional to the diﬀusion proﬁle. We can generate such samples within a plane, but projecting this density through a solid can oversample some parts of the surface and undersample others. Using MIS between multiple planes [KKCF13] helps prevent undersampling but oversampling is still a problem. Each plane sample also requires ray probing to ﬁnd surface hits, and if there are multiple intersections we build a conditional CDF based on the distance to each point, then stochastically choose a point to sample. The per-sample cost is substantial.
2.5 Path-traced subsurface scattering
We are now ﬁnding that path-traced subsurface scattering can be a practical alternative that is nearly as eﬃcient as diﬀusion while avoiding most of the artifacts. Figure 13 illustrates artifacts that can occur with diﬀusion on complex geometry, artifacts which go away with path-traced subsurface scattering. And Figure 14 shows that path-traced subsurface can be a practical production solution. In that image from Frozen Fever, the snowman, Marshmallow, is made up of both ice and snow which integrate seamlessly with path tracing. Previously, artists struggled with integrating ice with diﬀusion-rendered snow, and avoiding artifacts, especially in crevices.
10

Figure 13: Left: image rendered with subsurface diﬀusion. Small droplets are visibly too dark, and areas with complex folds are too bright, appearing emissive; both artifacts are due to integrating over a surface area that diﬀers from the inﬁnite slab assumed by diﬀusion models. Right: path-traced subsurface avoids these artifacts.
Figure 14: Image from Frozen Fever, rendered using path-traced subsurface. Image c Disney 2015.
11

1.2

1.4

1.6

1.8

2.0 IOR
Solid

Thin Surface

Figure 15: Left: Geometrically thin solid with IOR varying in strips, each with roughness of 0.35. The transmissive blurring obviously increases with IOR. Right: Thin-surface BSDF approximation with transmission roughness scaled by (0.65η − 0.35) to approximately match.

2.6 Thin-surface BSDF
For thin, translucent surfaces, we simulate both the entrance and exit scattering events at a single shading point as a combination of specular and diﬀuse transmission, controlled by our specTrans and diﬀTrans parameters in a manner analogous to our solid surface shader. The specTrans parameter blends between a fully diﬀuse model and a fully specular model. The diﬀTrans parameter transfers energy from the diﬀuse reﬂection lobe to the diﬀuse transmission lobe; a value of 1 makes the front and back lobes equal, and the value can be increased up to 2 to give all the energy to transmission. As with solids, the micro-surface diﬀuse eﬀects, sheen and diﬀuse retro-reﬂection, are included in the thinsurface front-side diﬀuse model and are unaﬀected by diﬀuse transmission. Additionally, we retain the subsurface approximation from our original BRDF as an alternate diﬀuse shape. This was originally controlled by the subsurface parameter which we have renamed ﬂatness to avoid confusion with true subsurface scattering.
We observe that bending due to refraction on thin surfaces approximately cancels, and thus we model specular transmission using a microfacet distribution equivalent to our BRDF specular lobe but reﬂected to the other side. However, this is not entirely satisfactory as the eﬀective transmission roughness should depend on the IOR since refractive bending can either amplify or attenuate the transmissive blurring. Indeed, if η = 1 then rays will pass right through the microfacets unperturbed. A better match can be achieved by scaling the roughness (for transmission only) based on the IOR as illustrated in Figure 15.
We approximate thin-surface diﬀuse transmission with an isotropic lobe. This is justiﬁed by the assumption that transmission due to subsurface scattering is isotropic. Our diﬀuse and specular transmission lobes are admittedly simplistic. Potential improvements are discussed in Section 5.2.

3 Disney BRDF Revisited
3.1 Schlick Fresnel
For our BRDF, we used the Schlick Fresnel approximation [Sch94], FSchlick(θi) = F0 + (1 − F0)(1 − cos θi)5. This was eﬃcient and reasonably accurate for plausible IOR values. However, care must be taken when used for refraction, especially when refracting out of an object where angles beyond the critical angle, θc = sin−1 η, should result in total internal reﬂection.
An easy way to adjust the Schlick approximation to account for the critical angle is to simply use

12

1.0

1.0

Fresnel (η = 0.4)

Fresnel (η = 1.02)

0.8

Schlick

0.8

Schlick

Schlick (θt)

0.6

0.6

F (θ) F (θ)

0.4

0.4

0.2

0.2

0.0 0

θc

θ

π/2

0.0 0

π/2 θ

Figure 16: Errors in Schlick approximation with refraction. Left: when the η < 1, as when refracting out of a solid, the Schlick approximation erroneously ignores the critical angle, θc; evaluating using the refracted angle θt rather than the reﬂected angle restores the approximation. Right: when the relative index of refraction is near 1, the error in the Schlick approximation becomes large.

the refracted angle F (θt) instead of the incident angle when the relative IOR is less than 1:

F0 =

1−η 2 1+η

cos2

θt

=

1

−

1

−

cos2 η2

θi

(7)

FSchlick|η<1(θi, η) =

F0 + (1 − F0)(1 − cos θt)5 1

if cos2 θt > 0 otherwise

This correction is illustrated in Figure 16, left. Another source of error with the Schlick approxi-

mation, viewing

illustrated in Figure an embedded solid,

16, right, occurs when the relative such as ice from under water (η

IOR is close = 1.33/1.31

t=.o

1. This can occur when 1.02). As a result, the

specular highlight on the ice can be nearly 40 times too bright. In the limit, surface reﬂection should

disappear as the relative IOR goes to 1, yet Schlick reﬂection remains the same.

For our BSDF, given that we already need to compute the refracted direction, and considering the

signiﬁcant error introduced near η = 1, we abandoned the Schlick approximation in favor of the exact

(unpolarized, dielectric) Fresnel equation:



F

(θi,

η)

=



1 2

cos θi−η cos θt cos θi+η cos θt

2
+

cos θt−η cos θi 2 cos θt+η cos θi

if cos2 θt > 0

(8)

1

otherwise

We observe that since we are already computing θt, the additional cost of computing the full Fresnel equation is negligible.
For our metallic BRDF, diﬀuse lobe, clearcoat, and specular tint, we still use the Schlick approximation. We discuss revisiting our metallic model later in section 5.3.

3.2 Index of Refraction
For our BRDF we avoided exposing IOR directly as a parameter because it was considered unintuitive for artists. Instead, we inferred the IOR from the Fresnel equation at normal incidence, controlled by the familiar specular param√eter but rescaled to a plausible range: F0 = 0.08 specular. The implied IOR was thus η = 2/(1 − F0) − 1 though this value was never needed given our use of the Schlick approximation. The normal range for specular of [0, 1] thus corresponded to an IOR range of [1, 1.8], with 0.5 notably corresponding to an IOR of 1.5, a typical value for polyurethane.

13

Figure 18: Production example from Big Hero 6 of layered material using parameter blending, with parameter values shown. Image c Disney 2014.

For our BSDF, the IOR controls the degree of bending for

0.12

refractive solids. To ensure energy conservation and plausibility, 0.10

F0(η)

we require the same IOR to be used for reﬂection and refraction, 0.08 and our artists now ﬁnd it intuitive to control this with the IOR directly when they understand the plausible range. IOR values 0.06

range from 1 for air to perhaps 2 for the vast majority of materials 0.04

with most common materials in the 1.3–1.6 range and only a few extremely dense materials going beyond 2 (e.g. for diamond, η ≈ 2.5), and [Pol08]. Artists merely need to understand that the plausible range is [1, 2] with common materials close to 1.5.
A secondary goal of our BRDF was choosing linear or perceptually linear parameters to enable parameter blending, so that

0.02
0.001.0 1.2 1.4 1.6 1.8 2.0 η
Figure 17: Incident reﬂectance F0 vs. IOR is nearly linear in the common material range of [1.3, 1.6].

an equal blend of parameters would reasonably approximate an

equal blend of materials. Fortunately, the IOR is reasonably linear with respect to the incident re-

ﬂectance in the plausible range as seen in Figure 17. This means that a mix of two IOR values will

produce almost the same result as the interpolated incident reﬂectance.

3.3 Smith G
As we noted in a 2014 addendum to our 2012 notes [Bur12] and restate here, based on Heitz’ analysis [Hei14] we eliminated our ad hoc remapping of the Smith G roughness for our primary specular lobe, and we adopted Heitz’ anisotropic form. The result is obviously better for metals and arguably better for non-metals, though the G term still loses energy, an issue we discuss further in Section 5.1. Our clearcoat specular lobe remains unmodiﬁed.

3.4 Parameter blending with pass-through
In our 2012 notes, we described a user interface for layered materials where each layer deﬁnes a speciﬁc set of parameter values and then these layers are “parameter blended” according to spatially varying

14

Figure 19: Production still from Big Hero 6. Image c Disney 2014.
masks. The blended values produce plausible in-between material results and avoid expensive multiBRDF integration. This turned out to be very intuitive for artists and remains our sole interface for material speciﬁcation.
Originally, we had 10 parameters in our reﬂectance layers. With the BSDF, we now have 12 for solids, adding specTrans and scatterDistance, or 13 for thin surfaces, adding specTrans, diﬀTrans, and ﬂatness as previously described. To make this less cumbersome when adding non-translucent layers, we added a new feature to our UI, parameter pass-through.
With parameter pass-through, artists can leave entries in the table blank. During parameter blending, when a blank is encountered, the previously blended result will be held. This simple change has greatly improved the usability of the layering interface.
A production example of a layered material is shown in Figure 18 along with the UI and values used.
4 Production Results
Our new BSDF was used on every surface in Big Hero 6 except for hair, and refractive eﬀects of all types were used extensively. In the production still shown in Figure 19, Baymax uses thin-surface shading with a blend of diﬀuse and specular transmission, convincingly conveying that he is made of inﬂated vinyl. Thin-surface shading was also used variously for cloth and paper. Windows were typically modeled as refractive solids. Figure 20 shows an additional still with several refractive solids. All skin and many solid objects such as plastic were rendered using normalized diﬀusion.
Rendering of the images in Big Hero 6 used multi-bounce path tracing, with the full BSDF response on every bounce. The BSDF proved to be robust and easy to control, with predictable results in all lighting conditions. In particular, artists found it easy to seamlessly blend between various refractive eﬀects, and our new parameter pass-through UI made layering especially easy, with artists reaching a new level of productivity. The BSDF also proved eﬃcient enough to enable an average to 10.5 billion shader evaluations per frame.
15

Figure 20: Production still from Big Hero 6. Image c Disney 2014.
Figure 21: Left: A rough glass sphere (IOR=1.5, roughness=0.25) is rendered in a furnace and exhibits energy loss at grazing angles. Right: Adding sheen with a strength of 4.0 approximately replaces the energy loss.
5 Future
5.1 Energy conservation
The principle of energy conservation in reﬂectance modeling is generally understood to mean that a surface cannot reﬂect more energy than it receives, however it is just as important that a surface not lose energy. Of course, surfaces do absorb energy which results in their apparent color or albedo, but if a surface is modeled without absorption then ideally all energy should be reﬂected.
The so-called furnace test is often used to test energy conservation. When rendered in an environment with uniform radiance, an energy-conserving material with albedo 1 will “disappear” whereas a non-conserving material will either appear too light or too dark, or both, depending on viewing angle. Heitz noted that microfacet models typically do not model multiple scattering and thus do not pass the furnace test [Hei14]. Energy that is shadowed by the microfacet G factor is lost. Heitz proposed the “weak white furnace test” as a method for validating microfacet models, that they at least conserve energy up to the ﬁrst scattering event and only lose energy from multiple scattering between microfacets. In the weak test, the shadowing term is omitted which represents measuring radiance after the ﬁrst scattering event but before scattered rays are shadowed by the microsurface. The Smith shadowing function is shown to pass such a test, however it fundamentally still loses energy.
The eﬀect of microfacet energy loss can be observed in Figure 21 where a rough glass sphere appears dark on the edge when rendered in a furnace. Multi-bounce path tracing is used for internal reﬂection.
16

This isn’t just a theoretical problem: this image is representative of what rough glass looks like when rendered with existing microfacet models in an evenly lit environment, that it looks unnaturally dark on the edges.
We note anecdotally, and show in Figure 21, that adding sheen can make the glass sphere almost perfectly pass the furnace test. This is not to say that our sheen model is accurate, and in fact it has the wrong shape for other roughness values, but rather the motivation for having it is justiﬁed. The motivation for our diﬀuse retroreﬂection is similarly justiﬁed.
For future work, we would like to revisit our retroreﬂection and sheen components and potentially replace them with components that correctly conserve energy. For example, recent work by Jakob et al. [JdJM14] proposes a diﬀuse correction term to replace lost energy from microfacet interreﬂection.
5.2 Better thin-sheet model
As we previously discussed, our thin-sheet model is overly simplistic and we would like to revisit our formulation. Recent work proposes more rigorously deﬁned and experimentally validated models for both specular and diﬀuse transmission through thin sheets [GQP15, PdMJ14].
5.3 Better metallic model
Our metallic model diﬀers from true metallic response in that we use the Schlick Fresnel approximation. The correct Fresnel equations for conductors have a more complex shape that depends on an additional material parameter, the material’s spectral absorption coeﬃcient, k. The relationship between IOR, the absorption coeﬃcient, and the resulting color is unintuitive, and arbitrary parameter combinations are implausible.
Recent work by Gulbrandsen [Gul14] promises artist-friendly control by reparameterizing the (spectral) IOR and absorption coeﬃcients via direct speciﬁcation of incident and edge colors, a parameterization we hope to investigate with our artists.
6 Conclusion
We have presented our new Disney BSDF, an extension of our BRDF with integrated refraction and subsurface scattering, and we have described our novel diﬀusion proﬁle which has eﬃciency, accuracy, and controllability advantages. We have shown production examples and discussed implementation issues and limitations.
In conclusion, we would like to emphasize that we believe the value of our model comes more from our uniﬁed approach—having a single model with a intuitive, minimal set of parameters that can be used for nearly all materials—and less from the speciﬁc constituent parts. We will continue to improve the robustness or plausibility of the model and extend it as our needs dictate, but we remain committed to the generality and simplicity of our approach.
7 Acknowledgements
As with the BRDF, Chuck Tappan was instrumental in guiding the development of our BSDF and championing its adoption in production. The Hyperion development team was also critical in implementing the model in our new path-tracing renderer, especially Matt Chiang, Peter Kutz, Christian Eisenacher, and Greg Nichols. I would also like to thank the Big Hero 6 crew for their enthusiastic and patient support. Finally, I would like to thank Stephen Hill for his helpful suggestions.
17

References

[Bur12]

Brent Burley. Physically-based shading at Disney, course notes, revised 2014. In ACM SIGGRAPH, Practical physically-based shading in ﬁlm and game production, 2012.

[CB15]

Per Christensen and Brent Burley. Approximate reﬂectance proﬁles for eﬃcient subsurface scattering. Technical Report 15-04, Pixar, 2015.

[CT81]

R. L. Cook and K. E. Torrance. A reﬂectance model for computer graphics. Computer Graphics, 15(3):307–316, 1981.

[dI11]

Eugene d’Eon and Geoﬀrey Irving. A quantized-diﬀusion model for rendering translucent materials. In ACM Transactions on Graphics (TOG), volume 30, page 56. ACM, 2011.

[GQP15]

Jie Guo, Jinghui Qian, and Jingui Pan. Practical rendering of thin layered materials with extended microfacet normal distributions. In Jaakko Lehtinen and Derek Nowrouzezahrai, editors, Eurographics Symposium on Rendering. The Eurographics Association, 2015.

[Gul14]

Ole Gulbrandsen. Artist friendly metallic fresnel. Journal of Computer Graphics Techniques Vol, 3(4), 2014.

[HCJ13]

Ralf Habel, Per H Christensen, and Wojciech Jarosz. Photon beam diﬀusion: A hybrid monte carlo method for subsurface scattering. In Computer Graphics Forum, volume 32, pages 27–37. Wiley Online Library, 2013.

[Hei14]

Eric Heitz. Understanding the masking-shadowing function in microfacet-based brdfs. Journal of Computer Graphics Techniques, 3(2):32–91, 2014.

[JB02]

Henrik Wann Jensen and Juan Buhler. A rapid hierarchical rendering technique for translucent materials. ACM Transactions on Graphics (TOG), 21(3):576–581, 2002.

[JdJM14] Wenzel Jakob, Eugene d’Eon, Otto Jakob, and Steve Marschner. A comprehensive framework for rendering layered materials. ACM Trans. Graph., 33(4):118:1–118:14, July 2014.

[JMLH01]

Henrik Wann Jensen, Stephen R. Marschner, Marc Levoy, and Pat Hanrahan. A practical model for subsurface light transport. In Proceedings of the 28th Annual Conference on Computer Graphics and Interactive Techniques, SIGGRAPH ’01, pages 511–518, New York, NY, USA, 2001. ACM.

[KKCF13] Alan King, Christopher Kulla, Alejandro Conty, and Marcos Fajardo. BSSRDF importance sampling. In ACM SIGGRAPH 2013 Talks. ACM, 2013.

[MPBM03] Wojciech Matusik, Hanspeter Pﬁster, Matt Brand, and Leonard McMillan. A data-driven reﬂectance model. ACM Transactions on Graphics, 22(3):759–769, July 2003.

[PdMJ14] Marios Papas, Krystle de Mesa, and Henrik Wann Jensen. A physically-based bsdf for modeling the appearance of paper. In Computer Graphics Forum, volume 33, pages 133– 142. Wiley Online Library, 2014.

[Pol08]

Mikhail Polyanskiy. Refractive index database. http://refractiveindex.info, 2008. Accessed: 2015-08-03.

[Sch94]

Christophe Schlick. An inexpensive BRDF model for physically-based rendering. Computer Graphics Forum, 13(3):233–246, 1994.

18

[Vea97]

Eric Veach. Robust monte carlo methods for light transport simulation. PhD thesis, Stanford University, 1997.

[WMLT07] Bruce Walter, Stephen R. Marschner, Hongsong Li, and Kenneth E. Torrance. Microfacet models for refraction through rough surfaces. In Proceedings of the Eurographics Symposium on Rendering, 2007.

19

